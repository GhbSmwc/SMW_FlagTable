<html>
	<head>
		<style>
			html {
			background-color: white;
			color: black;
			font-family: sans-serif;
			}
			
			table, th, td {
			border: 1px solid black;
			border-collapse: collapse;
			}
			
			span.NoLineBreak {
				white-space: nowrap;
			}
		</style>
	</head>
	<body onload="Calculate()">
	
	<kbd>!Freeram_MemoryFlag = </kbd>$<input type="text" onchange="Calculate()" value="7FAD49" id="Freeram_MemoryFlag" list="MemoryFlagTables"><button onclick="IncreaseDecreaseHexInput(1, 'Freeram_MemoryFlag', 0, parseInt('FFFFFF', 16)) ">+</button><button onclick="IncreaseDecreaseHexInput(-1, 'Freeram_MemoryFlag', 0, parseInt('FFFFFF', 16)) ">-</button>
	<datalist id="MemoryFlagTables">
	<option value="7FAD49">Default RAM address</option>
	<option value="4001B9">Default RAM address (SA-1)</option>
	</datalist><br>
	Number of group-128s = <input type="number" onchange="Calculate()" value="2" min="1" max="16" id="NumberOfGroup128"><br><br>
	
	<span id="Output"></span>
<script>
	function Calculate() {
		var MemoryFlag = clamp(parseInt(document.getElementById("Freeram_MemoryFlag").value, 16), 0, parseInt("FFFFFF", 16))
		document.getElementById("Freeram_MemoryFlag").value = MemoryFlag.toString(16).toUpperCase()
		var NumberOfGroup128 = clamp(parseInt(document.getElementById("NumberOfGroup128").value, 10), 1, 16)
		document.getElementById("NumberOfGroup128").value = NumberOfGroup128.toString(10)
		
		var NumberOfBytes = NumberOfGroup128*16
		var TotalNumberOfBits = NumberOfBytes*8
		
		var Output = ""
		document.getElementById("Output").innerHTML = ""
		
		Output += "<table>"
		Output += "<tr>"
		Output += "<td><kbd>!Freeram_MemoryFlag</kbd> range:</td>"
		Output += "<td><kbd>$" + MemoryFlag.toString(16).toUpperCase() + "</kbd> to <kbd>$" + (MemoryFlag+(NumberOfBytes-1)).toString(16).toUpperCase() + "</kbd></td>"
		Output += "<tr>"
		Output += "<tr>"
		Output += "<td><kbd>Group-128 numbering:</td>"
		Output += "<td><kbd>$0</kbd> to <kbd>$" + (NumberOfGroup128-1).toString(16).toUpperCase() + "</kbd></td>"
		Output += "</tr>"
		Output += "</table><br>"
		
		var BitIndexCount = 0
		var WhatBitInByte = [
		"<kbd>%-------X</kbd> (bit <kbd>0</kbd>)",
		"<kbd>%------X-</kbd> (bit <kbd>1</kbd>)",
		"<kbd>%-----X--</kbd> (bit <kbd>2</kbd>)",
		"<kbd>%----X---</kbd> (bit <kbd>3</kbd>)",
		"<kbd>%---X----</kbd> (bit <kbd>4</kbd>)",
		"<kbd>%--X-----</kbd> (bit <kbd>5</kbd>)",
		"<kbd>%-X------</kbd> (bit <kbd>6</kbd>)",
		"<kbd>%X-------</kbd> (bit <kbd>7</kbd>)",
		]
		
		Output += "<table>"
		Output += "<tr>"
		Output += "<th>Address of <kbd>!Freeram_MemoryFlag</kbd></th>"
		Output += "<th>LM's <kbd>$7FC060</kbd></th>"
		Output += "<th>Flag number</th>"
		Output += "<th>Bit in byte</th>"
		Output += "</tr>"
		
		for (BitIndexCount = 0; BitIndexCount < TotalNumberOfBits; BitIndexCount++) {
			if ((BitIndexCount % 128) == 0) {
				Output += "<tr><th colspan='4'>Group <kbd>$" + (Math.floor(BitIndexCount/128)).toString(16).toUpperCase() + "</kbd></th></tr>"
			}
			Output += "<tr>"
			if ((BitIndexCount % 8) == 0) {
				Output += "<td rowspan='8'><kbd>$" + (MemoryFlag+(Math.floor(BitIndexCount/8))).toString(16).toUpperCase() + "</kbd> (<kbd>!Freeram_MemoryFlag+$" + (Math.floor(BitIndexCount/8)).toString(16).toUpperCase() + "</kbd>)</td>"
			}
			if ((BitIndexCount % 8) == 0) {
				Output += "<td rowspan='8'><kbd>$" + (parseInt("7FC060", 16) + (Math.floor(BitIndexCount/8)) % 16).toString(16).toUpperCase()  + "</kbd></td>"
			}
			Output += "<td><kbd>" + BitIndexCount.toString(10) + "</kbd> (<kbd>$" + BitIndexCount.toString(16).toUpperCase() + "</kbd>)</td>"
			Output += "<td>" + WhatBitInByte[BitIndexCount % 8] + "</td>"
			Output += "</tr>"
		}
		Output += "</table>"
		document.getElementById("Output").innerHTML = Output
	}
	function clamp(num, min, max) {
		//Restrict a number within a specified range.
		if (isNaN(num) == true) {
			num = 0
		}
		return num <= min ? min : num >= max ? max : num;
	}
	function IncreaseDecreaseHexInput(ChangeBy, WhatInput, Min, Max) {
		//To be used along with a hex input the user enters.
		//This function is for the increment/decrement buttons since
		//only the "number" input (only allows characters 0-9) allows
		//the increment/decrement action (up/down button when selected,
		//and pressing up and down)
		document.getElementById(WhatInput).value = clamp((parseInt(document.getElementById(WhatInput).value, 16) + ChangeBy), Min, Max).toString(16).toUpperCase()
		Calculate()
	}
</script>